'use strict';window.ExpConsentUtils=window.ExpConsentUtils||{};window.ExpConsentUtils=function(){return{waitForObj:function(f){return new Promise(function(d,c){var h=0,k=setInterval(function(){100>h?"visitor"==f&&"object"===typeof visitor&&visitor||"consent"==f&&"undefined"!==typeof WcpConsent&&WcpConsent&&"undefined"!==typeof WcpConsent.siteConsent&&WcpConsent.siteConsent&&"undefined"!==typeof GPC_DataSharingOptIn&&null!=GPC_DataSharingOptIn?(clearInterval(k),d()):h++:(clearInterval(k),c())},50)})}}}();
var ExpConsentHandler=function(){function f(){window.ExpConsentUtils.waitForObj("visitor").then(function(){visitor.getVisitorValues(function(a){adobe.target.trackEvent({mbox:"personalizationConsent"})})}).catch(function(a){console.log(a)})}function d(){return WcpConsent&&WcpConsent.siteConsent&&void 0!==WcpConsent.siteConsent.isConsentRequired&&null!==WcpConsent.siteConsent.isConsentRequired?WcpConsent.siteConsent.isConsentRequired:!0}function c(){var a=WcpConsent&&WcpConsent.siteConsent&&0!==Object.keys(WcpConsent.siteConsent).length?
WcpConsent.siteConsent.getConsent():void 0;return a&&a.Advertising&&a.Analytics&&a.SocialMedia}function h(a,b){var e=k(a),g=new Date;g.setTime(g.getTime()+b);b="expires\x3d"+g.toUTCString();document.cookie=a+"\x3d"+e+"; "+b+"; path\x3d/;domain\x3d.microsoft.com;"}function k(a){var b=a+"\x3d",e;decodeURIComponent(document.cookie).split("; ").forEach(function(g){0===g.indexOf(b)&&(e=g.substring(b.length))});return e}function l(a){for(var b=0;b<a.length;b++)document.cookie=a[b]+"\x3d;max-age\x3d-1;path\x3d/;domain\x3d.microsoft.com;"}
function m(){if(GPC_DataSharingOptIn&&c())n(),h("mbox",34186698E3),f();else{l(["AMCV_EA76ADE95776D2EC7F000101%40AdobeOrg","AMCVS_EA76ADE95776D2EC7F000101%40AdobeOrg"]);var a=document.getElementById("visitor-script");a&&a.remove();h("mbox",2592E6)}}function p(){GPC_DataSharingOptIn&&c()||l(["mbox","AMCV_EA76ADE95776D2EC7F000101%40AdobeOrg","AMCVS_EA76ADE95776D2EC7F000101%40AdobeOrg"])}function q(){window.ExpConsentUtils.waitForObj("consent").then(function(){var a=window.cas.exp.target.isExpWithoutPersonalizationEnabled;
if(d())if(a)WcpConsent.onConsentChanged(m);else WcpConsent.onConsentChanged(p);!GPC_DataSharingOptIn||d()&&!c()||n();if(a||!d()||c()){var b="/etc.clientlibs/microsoft/components/structure/page/clientlibs/experimentation.ACSHASH"+window.cas.exp.target.expJsHash+".min.js",e=document.createElement("script");e.type="text/javascript";e.src=b;b=document.getElementsByName("exp-atjs-anchor")[0];b.parentElement.insertBefore(e,b)}a&&d()&&c()&&f()}).catch(function(a){console.log(a)})}function n(){var a="/etc.clientlibs/microsoft/components/structure/page/clientlibs/visitor.ACSHASH"+
window.cas.exp.target.visitorJsHash+".min.js",b=document.createElement("script");b.type="text/javascript";b.src=a;b.id="visitor-script";a=document.getElementsByName("exp-visitor-anchor")[0];a.parentElement.insertBefore(b,a)}"object"===typeof exports&&(module.exports={consentChangeCallBackEwp:m,handleExpScripts:q,isConsentRequired:d,checkUserConsent:c,syncTargetProfileWithMCID:f,consentChangeCallBackVanilla:p});return{handleExpScripts:q,isConsentRequired:d,checkUserConsent:c}}();
"complete"===document.readyState||"interactive"===document.readyState?ExpConsentHandler.handleExpScripts():document.addEventListener("DOMContentLoaded",ExpConsentHandler.handleExpScripts,!1);